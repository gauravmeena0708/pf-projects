<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPFO Transfer Claim Risk Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tab-button.active {
            border-color: #4F46E5; /* indigo-600 */
            color: #4F46E5;
            background-color: #EEF2FF; /* indigo-50 */
        }
        .tab-button {
            transition: all 0.3s ease;
        }
        .risk-score-high {
            background-color: #FEE2E2; /* red-100 */
            color: #B91C1C; /* red-700 */
            border-color: #EF4444; /* red-500 */
        }
        .risk-score-medium {
            background-color: #FEF3C7; /* amber-100 */
            color: #B45309; /* amber-700 */
            border-color: #F59E0B; /* amber-500 */
        }
        .risk-score-low {
            background-color: #D1FAE5; /* green-100 */
            color: #047857; /* green-700 */
            border-color: #10B981; /* green-500 */
        }
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }
        .detail-item {
            background-color: #F9FAFB; /* gray-50 */
            padding: 0.75rem;
            border-radius: 0.375rem; /* rounded-md */
            border: 1px solid #E5E7EB; /* gray-200 */
        }
        .detail-label {
            font-weight: 500;
            color: #4B5563; /* gray-600 */
        }
        .detail-value {
            color: #1F2937; /* gray-800 */
        }
        /* Custom scrollbar for tab content if it overflows */
        .tab-content-wrapper::-webkit-scrollbar {
            width: 6px;
        }
        .tab-content-wrapper::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .tab-content-wrapper::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* slate-300 */
            border-radius: 10px;
        }
        .tab-content-wrapper::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* slate-500 */
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">
    <div class="container mx-auto max-w-7xl bg-white shadow-xl rounded-lg p-6 md:p-8">
        <header class="mb-6 md:mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-indigo-700">EPFO Transfer Claim Risk Analysis</h1>
            <p class="text-gray-600 text-sm">Claim ID: <span class="font-semibold" id="claimIdDisplay">TCL0012345678</span></p>
        </header>

        <div class="flex flex-col lg:flex-row gap-6 md:gap-8">
            <div class="flex-grow lg:w-3/4">
                <div class="mb-6 border-b border-gray-300">
                    <nav class="flex flex-wrap -mb-px" aria-label="Tabs">
                        <button data-tab="oldEst" class="tab-button active text-sm md:text-base whitespace-nowrap py-3 px-4 border-b-2 font-medium rounded-t-lg hover:bg-indigo-50">
                            Old Establishment
                        </button>
                        <button data-tab="memberAccount" class="tab-button text-sm md:text-base whitespace-nowrap py-3 px-4 border-b-2 font-medium rounded-t-lg hover:bg-indigo-50">
                            Member Account
                        </button>
                        <button data-tab="newEst" class="tab-button text-sm md:text-base whitespace-nowrap py-3 px-4 border-b-2 font-medium rounded-t-lg hover:bg-indigo-50">
                            New Establishment
                        </button>
                        <button data-tab="newEstCumulative" class="tab-button text-sm md:text-base whitespace-nowrap py-3 px-4 border-b-2 font-medium rounded-t-lg hover:bg-indigo-50">
                            New Est. (Cumulative)
                        </button>
                        <button data-tab="flags" class="tab-button text-sm md:text-base whitespace-nowrap py-3 px-4 border-b-2 font-medium rounded-t-lg hover:bg-indigo-50">
                            Anomalies/Flags
                        </button>
                    </nav>
                </div>

                <div id="tabContentWrapper" class="tab-content-wrapper overflow-y-auto" style="max-height: calc(100vh - 300px);">
                    <div id="oldEst" class="tab-pane active p-1">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">Old Establishment Details</h2>
                        <div class="details-grid">
                            <div class="detail-item"><span class="detail-label">Name:</span> <span class="detail-value" id="oldEstName">Global Tech Solutions Pvt. Ltd.</span></div>
                            <div class="detail-item"><span class="detail-label">EPFO Code:</span> <span class="detail-value" id="oldEstCode">DL/GGN/0012345/000</span></div>
                            <div class="detail-item"><span class="detail-label">Age of Est.:</span> <span class="detail-value" id="oldEstAge">15 Years</span></div>
                            <div class="detail-item"><span class="detail-label">Compliance History:</span> <span class="detail-value text-green-600" id="oldEstCompliance">Good (Regular Payments)</span></div>
                            <div class="detail-item"><span class="detail-label">Recent Transfer Claims:</span> <span class="detail-value" id="oldEstRecentTransfers">5 in last 3 months</span></div>
                            <div class="detail-item"><span class="detail-label">Industry Type:</span> <span class="detail-value" id="oldEstIndustry">IT Services</span></div>
                            <div class="detail-item"><span class="detail-label">Status:</span> <span class="detail-value" id="oldEstStatus">Active</span></div>
                        </div>
                    </div>

                    <div id="memberAccount" class="tab-pane hidden p-1">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">Member Account Details (Claimant)</h2>
                        <div class="details-grid">
                            <div class="detail-item"><span class="detail-label">Member Name:</span> <span class="detail-value" id="memberName">Rajesh Kumar</span></div>
                            <div class="detail-item"><span class="detail-label">UAN:</span> <span class="detail-value" id="memberUan">100987654321</span></div>
                            <div class="detail-item"><span class="detail-label">Claim Amount:</span> <span class="detail-value" id="memberClaimAmount">â‚¹ 1,50,000</span></div>
                            <div class="detail-item"><span class="detail-label">Member Age:</span> <span class="detail-value" id="memberAge">32 Years</span></div>
                            <div class="detail-item"><span class="detail-label">Service (Old Est.):</span> <span class="detail-value" id="memberServiceOldEst">3 Years 2 Months</span></div>
                            <div class="detail-item"><span class="detail-label">Last Contribution:</span> <span class="detail-value" id="memberLastContribution">25-Jan-2024 (4 months ago)</span></div>
                            <div class="detail-item"><span class="detail-label">Past Transfers:</span> <span class="detail-value" id="memberPastTransfers">1 (5 years ago)</span></div>
                            <div class="detail-item"><span class="detail-label">KYC Status:</span> <span class="detail-value text-green-600" id="memberKycStatus">Verified (Aadhaar, PAN, Bank)</span></div>
                            <div class="detail-item"><span class="detail-label">Bank A/C No.:</span> <span class="detail-value" id="memberBankAc">******1234 (SBI)</span></div>
                        </div>
                    </div>

                    <div id="newEst" class="tab-pane hidden p-1">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">New Establishment Details</h2>
                        <div class="details-grid">
                            <div class="detail-item"><span class="detail-label">Name:</span> <span class="detail-value" id="newEstName">Innovative Startups Co.</span></div>
                            <div class="detail-item"><span class="detail-label">EPFO Code:</span> <span class="detail-value" id="newEstCode">MH/PUN/0098765/000</span></div>
                            <div class="detail-item"><span class="detail-label">Age of Est.:</span> <span class="detail-value text-red-600" id="newEstAge">3 Months (Newly Registered)</span></div>
                            <div class="detail-item"><span class="detail-label">Contribution History:</span> <span class="detail-value text-yellow-600" id="newEstContribHistory">Minimal (1 payment cycle)</span></div>
                            <div class="detail-item"><span class="detail-label">No. of Employees:</span> <span class="detail-value" id="newEstEmployees">8</span></div>
                            <div class="detail-item"><span class="detail-label">Industry Type:</span> <span class="detail-value" id="newEstIndustry">Consulting</span></div>
                            <div class="detail-item"><span class="detail-label">Address Verified:</span> <span class="detail-value text-yellow-600" id="newEstAddressVerified">Pending</span></div>
                            <div class="detail-item"><span class="detail-label">Watchlist:</span> <span class="detail-value" id="newEstWatchlist">No</span></div>
                        </div>
                    </div>

                    <div id="newEstCumulative" class="tab-pane hidden p-1">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">New Establishment - Cumulative Member Data</h2>
                        <div class="details-grid">
                            <div class="detail-item"><span class="detail-label">Total Recent Transfers In:</span> <span class="detail-value text-red-600" id="newEstTotalTransfersIn">6 (in last 1 month)</span></div>
                            <div class="detail-item"><span class="detail-label">Avg. Age of Transferees:</span> <span class="detail-value" id="newEstAvgAgeTransferees">30 Years</span></div>
                            <div class="detail-item"><span class="detail-label">Avg. Service (Prev. Est):</span> <span class="detail-value" id="newEstAvgServicePrev">2.5 Years</span></div>
                            <div class="detail-item"><span class="detail-label">Common Source Est.:</span> <span class="detail-value text-red-600" id="newEstCommonSource">Yes (3 from 'Alpha Solutions')</span></div>
                            <div class="detail-item"><span class="detail-label">% Workforce from Transfers:</span> <span class="detail-value text-red-600" id="newEstPercentWorkforceTransfers">75% (6 out of 8)</span></div>
                        </div>
                    </div>
                     <div id="flags" class="tab-pane hidden p-1">
                        <h2 class="text-xl font-semibold text-gray-700 mb-4">Key Anomalies & Flags Identified</h2>
                        <ul id="anomaliesList" class="list-disc pl-5 space-y-2 text-gray-700">
                            </ul>
                    </div>
                </div>
            </div>

            <div class="lg:w-1/4 space-y-6">
                <div id="riskScoreCard" class="p-6 rounded-lg border-2 shadow-md"> <h3 class="text-lg font-semibold mb-1">Overall Risk Score</h3>
                    <p id="riskScoreValue" class="text-5xl font-bold mb-2">--</p>
                    <p id="riskLevel" class="text-xl font-semibold mb-4">Calculating...</p>
                    <div class="text-xs">
                        <p><span class="font-semibold">Model Version:</span> <span id="modelVersion">RS_v1.2</span></p>
                        <p><span class="font-semibold">Scored On:</span> <span id="scoredDate">29-May-2025</span></p>
                    </div>
                </div>

                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                    <h3 class="text-md font-semibold text-gray-800 mb-3">Key Contributing Factors:</h3>
                    <ul id="keyRiskFactorsList" class="list-disc pl-5 space-y-1 text-sm text-gray-600">
                        </ul>
                </div>

                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                    <h3 class="text-md font-semibold text-gray-800 mb-3">Actions</h3>
                    <div class="space-y-2">
                        <button class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition duration-150 ease-in-out">
                            Approve Claim
                        </button>
                        <button class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-2 px-4 rounded-lg transition duration-150 ease-in-out">
                            Send for Review
                        </button>
                        <button class="w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition duration-150 ease-in-out">
                            Reject Claim
                        </button>
                         <button class="w-full mt-2 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition duration-150 ease-in-out">
                            Request More Info
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const tabs = document.querySelectorAll('.tab-button');
        const panes = document.querySelectorAll('.tab-pane');
        const riskScoreCard = document.getElementById('riskScoreCard');
        const riskScoreValueEl = document.getElementById('riskScoreValue');
        const riskLevelEl = document.getElementById('riskLevel');
        const keyRiskFactorsList = document.getElementById('keyRiskFactorsList');
        const anomaliesListEl = document.getElementById('anomaliesList');

        // --- Data for the current claim (This would typically come from a backend API) ---
        const currentClaimData = {
            claimId: "TCL0012345678",
            riskProfile: "high", // Can be "low", "medium", or "high"
            riskScore: 82,
            riskLevel: "High Risk",
            keyFactors: [
                { text: "New Est. Age: Very Young", severity: "high" },
                { text: "High % Transferees in New Est.", severity: "high" },
                { text: "New Est. Address Unverified", severity: "medium" },
                { text: "Common Source Est. for Transfers", severity: "low" } // Example: low severity factor
            ],
            anomalies: [
                { text: "New establishment is very young (3 months).", severity: "high" },
                { text: "High percentage of workforce (75%) in new establishment are recent transfers.", severity: "high" },
                { text: "New establishment address verification pending.", severity: "medium" },
                { text: "Last contribution by member was 4 months ago (borderline, monitor).", severity: "low" },
                { text: "Multiple members (3) transferred from 'Alpha Solutions' to this new establishment recently.", severity: "high" },
                { text: "Claim amount is moderately high for service length.", severity: "low" }
            ],
            modelVersion: "RS_v1.3",
            scoredDate: new Date().toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric'}), // Formats as DD-Mon-YYYY
            
            // Detailed data for tabs (example structure)
            oldEstablishment: {
                name: "Global Tech Solutions Pvt. Ltd.",
                epfoCode: "DL/GGN/0012345/000",
                age: "15 Years",
                complianceHistory: "Good (Regular Payments)",
                complianceClass: "text-green-600",
                recentTransferClaims: "5 in last 3 months",
                industryType: "IT Services",
                status: "Active"
            },
            memberAccount: {
                name: "Rajesh Kumar",
                uan: "100987654321",
                claimAmount: "â‚¹ 1,50,000",
                age: "32 Years",
                serviceOldEst: "3 Years 2 Months",
                lastContribution: "25-Jan-2024 (4 months ago)",
                pastTransfers: "1 (5 years ago)",
                kycStatus: "Verified (Aadhaar, PAN, Bank)",
                kycClass: "text-green-600",
                bankAc: "******1234 (SBI)"
            },
            newEstablishment: {
                name: "Innovative Startups Co.",
                epfoCode: "MH/PUN/0098765/000",
                age: "3 Months (Newly Registered)",
                ageClass: "text-red-600",
                contribHistory: "Minimal (1 payment cycle)",
                contribHistoryClass: "text-yellow-600",
                employees: "8",
                industryType: "Consulting",
                addressVerified: "Pending",
                addressVerifiedClass: "text-yellow-600",
                watchlist: "No"
            },
            newEstablishmentCumulative: {
                totalRecentTransfersIn: "6 (in last 1 month)",
                totalRecentTransfersInClass: "text-red-600",
                avgAgeTransferees: "30 Years",
                avgServicePrevEst: "2.5 Years",
                commonSourceEst: "Yes (3 from 'Alpha Solutions')",
                commonSourceEstClass: "text-red-600",
                percentWorkforceFromTransfers: "75% (6 out of 8)",
                percentWorkforceFromTransfersClass: "text-red-600"
            }
        };

        // Function to populate data into the UI fields
        function populateClaimData(data) {
            document.getElementById('claimIdDisplay').textContent = data.claimId;
            document.getElementById('modelVersion').textContent = data.modelVersion;
            document.getElementById('scoredDate').textContent = data.scoredDate;

            // Old Establishment
            document.getElementById('oldEstName').textContent = data.oldEstablishment.name;
            document.getElementById('oldEstCode').textContent = data.oldEstablishment.epfoCode;
            document.getElementById('oldEstAge').textContent = data.oldEstablishment.age;
            document.getElementById('oldEstCompliance').textContent = data.oldEstablishment.complianceHistory;
            document.getElementById('oldEstCompliance').className = `detail-value ${data.oldEstablishment.complianceClass || ''}`;
            document.getElementById('oldEstRecentTransfers').textContent = data.oldEstablishment.recentTransferClaims;
            document.getElementById('oldEstIndustry').textContent = data.oldEstablishment.industryType;
            document.getElementById('oldEstStatus').textContent = data.oldEstablishment.status;
            
            // Member Account
            document.getElementById('memberName').textContent = data.memberAccount.name;
            document.getElementById('memberUan').textContent = data.memberAccount.uan;
            document.getElementById('memberClaimAmount').textContent = data.memberAccount.claimAmount;
            document.getElementById('memberAge').textContent = data.memberAccount.age;
            document.getElementById('memberServiceOldEst').textContent = data.memberAccount.serviceOldEst;
            document.getElementById('memberLastContribution').textContent = data.memberAccount.lastContribution;
            document.getElementById('memberPastTransfers').textContent = data.memberAccount.pastTransfers;
            document.getElementById('memberKycStatus').textContent = data.memberAccount.kycStatus;
            document.getElementById('memberKycStatus').className = `detail-value ${data.memberAccount.kycClass || ''}`;
            document.getElementById('memberBankAc').textContent = data.memberAccount.bankAc;

            // New Establishment
            document.getElementById('newEstName').textContent = data.newEstablishment.name;
            document.getElementById('newEstCode').textContent = data.newEstablishment.epfoCode;
            document.getElementById('newEstAge').textContent = data.newEstablishment.age;
            document.getElementById('newEstAge').className = `detail-value ${data.newEstablishment.ageClass || ''}`;
            document.getElementById('newEstContribHistory').textContent = data.newEstablishment.contribHistory;
            document.getElementById('newEstContribHistory').className = `detail-value ${data.newEstablishment.contribHistoryClass || ''}`;
            document.getElementById('newEstEmployees').textContent = data.newEstablishment.employees;
            document.getElementById('newEstIndustry').textContent = data.newEstablishment.industryType;
            document.getElementById('newEstAddressVerified').textContent = data.newEstablishment.addressVerified;
            document.getElementById('newEstAddressVerified').className = `detail-value ${data.newEstablishment.addressVerifiedClass || ''}`;
            document.getElementById('newEstWatchlist').textContent = data.newEstablishment.watchlist;

            // New Establishment Cumulative
            document.getElementById('newEstTotalTransfersIn').textContent = data.newEstablishmentCumulative.totalRecentTransfersIn;
            document.getElementById('newEstTotalTransfersIn').className = `detail-value ${data.newEstablishmentCumulative.totalRecentTransfersInClass || ''}`;
            document.getElementById('newEstAvgAgeTransferees').textContent = data.newEstablishmentCumulative.avgAgeTransferees;
            document.getElementById('newEstAvgServicePrev').textContent = data.newEstablishmentCumulative.avgServicePrevEst;
            document.getElementById('newEstCommonSource').textContent = data.newEstablishmentCumulative.commonSourceEst;
            document.getElementById('newEstCommonSource').className = `detail-value ${data.newEstablishmentCumulative.commonSourceEstClass || ''}`;
            document.getElementById('newEstPercentWorkforceTransfers').textContent = data.newEstablishmentCumulative.percentWorkforceFromTransfers;
            document.getElementById('newEstPercentWorkforceTransfers').className = `detail-value ${data.newEstablishmentCumulative.percentWorkforceFromTransfersClass || ''}`;
        }


        // Function to update risk display (called once on load)
        function displayOverallRisk(claim) {
            riskScoreValueEl.textContent = claim.riskScore;
            riskLevelEl.textContent = claim.riskLevel;
            
            // Set card class based on risk profile
            riskScoreCard.classList.remove('risk-score-low', 'risk-score-medium', 'risk-score-high');
            if (claim.riskProfile === "low") riskScoreCard.classList.add('risk-score-low');
            else if (claim.riskProfile === "medium") riskScoreCard.classList.add('risk-score-medium');
            else if (claim.riskProfile === "high") riskScoreCard.classList.add('risk-score-high');

            // Populate Key Risk Factors
            keyRiskFactorsList.innerHTML = ''; // Clear previous factors
            claim.keyFactors.forEach(factor => {
                const li = document.createElement('li');
                if (factor.severity === 'high') li.classList.add('text-red-500');
                else if (factor.severity === 'medium') li.classList.add('text-orange-500');
                // else 'low' severity factors get default text color
                li.textContent = factor.text;
                keyRiskFactorsList.appendChild(li);
            });

            // Populate Anomalies/Flags tab
            anomaliesListEl.innerHTML = '';
            claim.anomalies.forEach(anomaly => {
                const li = document.createElement('li');
                 if (anomaly.severity === 'high') li.classList.add('text-red-600', 'font-medium');
                else if (anomaly.severity === 'medium') li.classList.add('text-yellow-600', 'font-medium');
                // else 'low' severity anomalies get default text color and font weight
                li.textContent = anomaly.text;
                anomaliesListEl.appendChild(li);
            });
        }

        // Tab switching logic
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Deactivate all tabs and panes
                tabs.forEach(t => {
                    t.classList.remove('active');
                    // More specific class removal and addition for better style management
                    t.classList.remove('border-indigo-600', 'text-indigo-600', 'bg-indigo-50');
                    t.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                });
                panes.forEach(pane => {
                    pane.classList.add('hidden');
                });

                // Activate clicked tab and corresponding pane
                tab.classList.add('active');
                tab.classList.add('border-indigo-600', 'text-indigo-600', 'bg-indigo-50');
                tab.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                
                const targetPaneId = tab.getAttribute('data-tab');
                const targetPane = document.getElementById(targetPaneId);
                if (targetPane) {
                    targetPane.classList.remove('hidden');
                }
                // IMPORTANT: The risk score display is NOT updated on tab click anymore.
                // It's set once on page load.
            });
        });
        
        // --- Initialize page on load ---
        document.addEventListener('DOMContentLoaded', () => {
            populateClaimData(currentClaimData); // Populate all data fields
            displayOverallRisk(currentClaimData); // Display the static overall risk score and factors

            // Ensure the first tab is correctly styled as active
            const initialActiveTab = document.querySelector('.tab-button.active');
            if (initialActiveTab) {
                initialActiveTab.classList.add('border-indigo-600', 'text-indigo-600', 'bg-indigo-50');
                initialActiveTab.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
            }
        });

    </script>
</body>
</html>
